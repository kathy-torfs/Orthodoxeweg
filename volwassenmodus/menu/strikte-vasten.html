<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Recepten â€“ Orthodoxeweg</title>
  <link rel="icon" href="https://kathy-torfs.github.io/Orthodoxeweg/images/kruis.png">
  <style>
    body { background:#f5e9b8; font-family:Arial,sans-serif; margin:0; padding:0; color:#6f4e1a; }

    /* Container */
    .bak-container {
      max-width: 1000px;
      margin: 30px auto;
      padding: 0 16px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
    }

    /* Receptkaart */
    .kaart {
      background: #fffdf6;
      border: 2px solid #e0c88c;
      border-radius: 14px;
      box-shadow: 0 4px 14px rgba(0,0,0,0.15);
      padding: 18px 16px;
      display: flex;
      flex-direction: column;
      transition: transform 0.15s;
    }
    .kaart:hover { transform: translateY(-3px); }

    .kaart h3 {
      margin: 0 0 12px 0;
      font-size: 1.25em;
      color:#7a5f35;
      border-bottom: 1px solid #e6d4a5;
      padding-bottom: 4px;
    }

    .kaart .sectie {
      margin-bottom: 12px;
    }
    .kaart .sectie strong {
      display:block;
      margin-bottom:4px;
      color:#5b4116;
    }

    .kaart p {
      margin: 0 0 8px 0;
      line-height:1.5;
      white-space: pre-line;
    }

    /* Pluskaart */
    .plus-kaart {
      background:#fdf1d2;
      border:2px dashed #c79c43;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:3em;
      color:#a6792d;
      cursor:pointer;
      transition: background 0.2s, transform 0.15s;
    }
    .plus-kaart:hover {
      background:#fde6b1;
      transform: scale(1.05);
    }

    /* Bewerkbare kaart */
    .kaart input, .kaart textarea {
      width:100%;
      border:1.5px solid #d1b670;
      border-radius:8px;
      padding:8px;
      font-family:inherit;
      font-size:1em;
      margin-bottom:10px;
      box-sizing:border-box;
    }
    .kaart textarea { min-height:80px; resize:vertical; }

    .kaart .btn-row {
      display:flex; gap:10px; justify-content:flex-end; margin-top:8px;
    }
    .kaart button {
      border:none;
      border-radius:8px;
      padding:8px 14px;
      font-size:0.95em;
      cursor:pointer;
      font-weight:bold;
    }
    .opslaan-btn { background:#7bb235; color:white; }
    .annuleer-btn { background:#b09765; color:white; }
  </style>
</head>
<body>

  <!-- ==== GEMEENSCHAPPELIJKE HEADER ==== -->
  <div id="volwassen-header" data-header-src="../common/header.html"></div>
  <script src="../common/layout.js"></script>

  <main>
    <h1 style="text-align:center; margin:20px 0; color:#7a5f35;">ðŸ“– Receptenbak</h1>
    <div class="bak-container" id="receptenBak">
      <!-- Kaarten komen hier -->
      <div class="kaart plus-kaart" id="plusKaart">âž•</div>
    </div>
  </main>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey:"AIzaSyBG1iQBmruHUZI1OeW8RgbJ_TPit_7a2LQ",
      authDomain:"orthodoxeweg.firebaseapp.com",
      projectId:"orthodoxeweg",
      storageBucket:"orthodoxeweg.appspot.com",
      messagingSenderId:"408582263618",
      appId:"1:408582263618:web:0a20f4bf0704989d3ceedb"
    };
    if(!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const bak = document.getElementById("receptenBak");
    const plusKaart = document.getElementById("plusKaart");

    // Recept laden
    async function laadRecepten() {
      const snap = await db.collection("recepten").doc("strikte-vasten").collection("items").get();
      snap.forEach(doc => {
        toonKaart({id:doc.id, ...doc.data()});
      });
    }

    // Nieuwe kaart tonen
    function toonKaart(data) {
      const div = document.createElement("div");
      div.className="kaart";
      div.innerHTML = `
        <h3>${data.titel||"Naamloos recept"}</h3>
        <div class="sectie"><strong>IngrediÃ«nten</strong><p>${data.ingredienten||"-"}</p></div>
        <div class="sectie"><strong>Bereiding</strong><p>${data.bereiding||"-"}</p></div>
      `;
      bak.insertBefore(div, plusKaart);
    }

    // Nieuwe invulkaarten
    plusKaart.addEventListener("click", ()=> {
      const editDiv = document.createElement("div");
      editDiv.className="kaart";
      editDiv.innerHTML = `
        <input type="text" id="newTitel" placeholder="Titel van recept">
        <textarea id="newIngred" placeholder="IngrediÃ«nten..."></textarea>
        <textarea id="newBereiding" placeholder="Bereiding..."></textarea>
        <div class="btn-row">
          <button class="opslaan-btn">Opslaan</button>
          <button class="annuleer-btn">Annuleren</button>
        </div>
      `;
      bak.insertBefore(editDiv, plusKaart);

      const opslaanBtn = editDiv.querySelector(".opslaan-btn");
      const annuleerBtn = editDiv.querySelector(".annuleer-btn");

      opslaanBtn.onclick = async ()=>{
        const titel = editDiv.querySelector("#newTitel").value.trim();
        const ingred = editDiv.querySelector("#newIngred").value.trim();
        const bereid = editDiv.querySelector("#newBereiding").value.trim();
        if(!titel){ alert("Titel invullen"); return; }
        const nieuw = {titel, ingredienten:ingred, bereiding:bereid, gemaaktOp:new Date()};
        const docRef = await db.collection("recepten").doc("strikte-vasten").collection("items").add(nieuw);
        bak.removeChild(editDiv);
        toonKaart({id:docRef.id, ...nieuw});
      };
      annuleerBtn.onclick = ()=> bak.removeChild(editDiv);
    });

    // Init
    laadRecepten();
  </script>
</body>
</html>

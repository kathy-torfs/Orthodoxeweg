<!DOCTYPE html> 
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Orthodoxeweg - Dagkalender</title>
  <link rel="icon" href="images/kruis.png">
  <style>
    /* --- Jouw CSS blijft identiek --- */
    body { background-color:#f5e9b8; color:#6f4e1a; font-family:Arial,sans-serif; margin:0; padding:0; }
    .topbar { background-color:#6f4e1a; color:white; padding:12px 20px; display:flex; justify-content:space-between; align-items:center; font-weight:bold; }
    .uitlog-link { background-color:#8722aa; color:white; border:none; padding:8px 18px; border-radius:18px; cursor:pointer; font-weight:bold; }
    nav.menu { background-color:#7a5f35; padding:10px 15px; display:flex; flex-wrap:wrap; gap:12px; justify-content:center; }
    nav.menu a { color:#f5e9b8; text-decoration:none; font-weight:600; font-size:16px; padding:6px 12px; border-radius:8px; transition:background-color 0.3s; }
    nav.menu a:hover { background-color:#5d4726; text-decoration:underline; }
    .taalkeuze { text-align:center; margin:18px 0 6px 0; }
    .taalkeuze button { background:#eee3c6; color:#6f4e1a; border:1.5px solid #b29467; border-radius:6px; padding:7px 20px; font-size:1em; font-weight:bold; cursor:pointer; margin:0 6px; transition:background 0.2s; }
    .taalkeuze button.selected { background:#d3b87c; color:#3a2c17; border:2px solid #85652a; }
    /* rest CSS blijft exact zoals je gaf */
  </style>

  <!-- FIREBASE -->
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore-compat.js"></script>
  <script>
    if (!localStorage.getItem("ingelogdeParochie") || localStorage.getItem("modus") !== "priester") {
      window.location.href = "https://kathy-torfs.github.io/Orthodoxeweg/index.html";
    }
    const firebaseConfig = {
      apiKey: "AIzaSyBG1iQBmruHUZI1OeW8RgbJ_TPit_7a2LQ",
      authDomain: "orthodoxeweg.firebaseapp.com",
      projectId: "orthodoxeweg",
      storageBucket: "orthodoxeweg.appspot.com",
      messagingSenderId: "408582263618",
      appId: "1:408582263618:web:0a20f4bf0704989d3ceedb",
      measurementId: "G-C942F2NYQV"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>
</head>
<body>
  <div class="topbar">
    <div id="welkom-tekst"></div>
    <button class="uitlog-link" id="uitlogKnop">🚪 Uitloggen</button>
  </div>

  <nav class="menu">
    <a href="https://kathy-torfs.github.io/Orthodoxeweg/priestermodus/startpagina.html">🏠</a>
    <a href="https://kathy-torfs.github.io/Orthodoxeweg/priestermodus/parochie.html">🛐 Mijn parochie</a>
    <a href="https://kathy-torfs.github.io/Orthodoxeweg/priestermodus/catechese/catechese.html">📖 Catechese</a>
    <a href="https://kathy-torfs.github.io/Orthodoxeweg/priestermodus/gebeden/gebeden.html">🙏 Gebeden</a>
    <a href="https://kathy-torfs.github.io/Orthodoxeweg/priestermodus/gebeden/geloofsbelijdenis.html">✝ Geloofsbelijdenis</a>
    <a href="https://kathy-torfs.github.io/Orthodoxeweg/priestermodus/psalmen/psalmen.html">📜 Psalmen</a>
    <a href="https://kathy-torfs.github.io/Orthodoxeweg/priestermodus/heiligen/heiligen.html">👼 Heiligen</a>
    <a href="https://kathy-torfs.github.io/Orthodoxeweg/priestermodus/bijbeldagboek.html">📔 Bijbeldagboek</a>
    <a href="https://kathy-torfs.github.io/Orthodoxeweg/priestermodus/verjaardagskalender.html">🎂 Verjaardagskalender</a>
    <a href="https://kathy-torfs.github.io/Orthodoxeweg/priestermodus/layout.html" class="menu-kerk">⛪</a>
  </nav>

  <div class="taalkeuze">
    <button id="btn-vlaams" class="selected">🇧🇪 Vlaams</button>
    <button id="btn-engels">🇬🇧 English</button>
    <button id="btn-grieks">🇬🇷 Ελληνικά</button>
  </div>

  <div class="boek-wrapper">
    <div class="boek">
      <button class="hoek-linksonder" id="vorigeDag">&lt;</button>
      <div class="pagina links" id="boek-links"><div id="heilige-inhoud">Bezig met laden...</div></div>
      <div class="pagina rechts" id="boek-rechts">
        <div id="dagkalender-inhoud">Bezig met laden...</div>
        <div class="tip-blok" id="dagkalender-tip"></div>
      </div>
      <button class="hoek-rechtsonder" id="volgendeDag">&gt;</button>
    </div>
  </div>

  <script>
    // Begroeting
    const welkomTekst = document.getElementById("welkom-tekst");
    const uur = new Date().getHours();
    let moment = "goeiedag";
    if (uur >= 5 && uur <= 10) moment = "goeiemorgen";
    else if (uur >= 11 && uur <= 13) moment = "goeiemiddag";
    else if (uur >= 17 && uur <= 22) moment = "goeienavond";
    else if (uur > 22 || uur < 5) moment = "goedenacht";

    const parochie = localStorage.getItem("ingelogdeParochie") || "(onbekend)";
    welkomTekst.textContent = `${moment} vader, ik wens u een gezegende dag. U bent ingelogd in: ${parochie}`;

    document.getElementById("uitlogKnop").onclick = () => {
      localStorage.removeItem("modus");
      localStorage.removeItem("ingelogdeParochie");
      window.location.href = "https://kathy-torfs.github.io/Orthodoxeweg/index.html";
    };

    // Boeklogica
    let huidigeTaal = "vlaams";
    let actieveDatum = new Date();

    function pad(n) { return n<10 ? "0"+n : n; }

    document.getElementById("vorigeDag").onclick = () => { actieveDatum.setDate(actieveDatum.getDate()-1); laadAlles(); }
    document.getElementById("volgendeDag").onclick = () => { actieveDatum.setDate(actieveDatum.getDate()+1); laadAlles(); }
    document.getElementById("btn-vlaams").onclick = () => { huidigeTaal="vlaams"; setTaal(); }
    document.getElementById("btn-engels").onclick = () => { huidigeTaal="engels"; setTaal(); }
    document.getElementById("btn-grieks").onclick = () => { huidigeTaal="grieks"; setTaal(); }

    function setTaal() {
      document.querySelectorAll('.taalkeuze button').forEach(b=>b.classList.remove("selected"));
      document.getElementById("btn-vlaams").classList.toggle("selected",huidigeTaal==="vlaams");
      document.getElementById("btn-engels").classList.toggle("selected",huidigeTaal==="engels");
      document.getElementById("btn-grieks").classList.toggle("selected",huidigeTaal==="grieks");
      laadAlles();
    }

    function laadAlles() {
      const jaar = actieveDatum.getFullYear();
      const maand = pad(actieveDatum.getMonth()+1);
      const dag = pad(actieveDatum.getDate());
      const kalenderId = `${jaar}${maand}${dag}`;
      const feestdag = `${dag}-${maand}`;

      // LINKS
      const heiligeContainer = document.getElementById("heilige-inhoud");
      heiligeContainer.textContent = "Bezig met laden...";
      db.collection("heiligen").where("feestdag","==",feestdag).get().then(snapshot=>{
        if(snapshot.empty){ heiligeContainer.innerHTML="<div>Geen heilige gevonden.</div>"; return; }
        const data = snapshot.docs[Math.floor(Math.random()*snapshot.docs.length)].data();
        let naam="",levensverhaal="",fotoUrl=data.icoon||data.foto_url||"https://upload.wikimedia.org/wikipedia/commons/1/12/Orthodox_Cross.svg";
        if(huidigeTaal==="engels"){ naam=data["naam_en"]||""; levensverhaal=data["levensverhaal_en"]||""; }
        else if(huidigeTaal==="grieks"){ naam=data["naam_el"]||""; levensverhaal=data["levensverhaal_el"]||""; }
        else { naam=data["naam_nl"]||data.naam||"Heilige"; levensverhaal=data["levensverhaal_nl"]||data["levensverhaal_volwassenen"]||""; }
        heiligeContainer.innerHTML=`<div class="heilige-naam">${naam}</div><img src="${fotoUrl}" class="heilige-foto"><div class="heilige-levensverhaal">${levensverhaal}</div>`;
      });

      // RECHTS
      const kalenderContainer=document.getElementById("dagkalender-inhoud");
      const tipBlok=document.getElementById("dagkalender-tip");
      kalenderContainer.textContent="Bezig met laden...";
      tipBlok.textContent="";
      db.collection("kalender2025").doc(kalenderId).get().then(doc=>{
        if(!doc.exists){ kalenderContainer.innerHTML="<div>Geen kalenderinfo.</div>"; return; }
        const data=doc.data();
        let vasten=data["Vastenregel NL"]||"", symb=data["Symbool"]||"";
        if(huidigeTaal==="engels") vasten=data["Vastenregel EN"]||vasten;
        if(huidigeTaal==="grieks") vasten=data["Vastenregel EL"]||vasten;
        if(!vasten) vasten=huidigeTaal==="vlaams"?"Vastenvrij":huidigeTaal==="engels"?"Fasting Free":"Νηστεία ελεύθερη";
        let vastenRegelBlok=`<span>${vasten}</span>${symb?`<span class="vastenregel-symbool">${symb}</span>`:""}`;
        let datumTekst=`${dag}-${maand}-${jaar}`;
        let heiligen=data[huidigeTaal==="vlaams"?"Heiligen NL":huidigeTaal==="engels"?"Heiligen EN":"Heiligen EL"]||"";
        let epistel=data[huidigeTaal==="vlaams"?"Epistel Ref NL":huidigeTaal==="engels"?"Epistel Ref EN":"Epistel Ref EL"]||"";
        let evangelie=data[huidigeTaal==="vlaams"?"Evangelie Ref NL":huidigeTaal==="engels"?"Evangelie Ref EN":"Evangelie Ref EL"]||"";
        let epLabel=huidigeTaal==="engels"?"Epistle Reading":huidigeTaal==="grieks"?"Απόστολος":"Apostellezing";
        let evLabel=huidigeTaal==="engels"?"Gospel Reading":huidigeTaal==="grieks"?"Ευαγγέλιο":"Evangelielezing";
        let tip=data[huidigeTaal==="vlaams"?"Tip/Wens NL":huidigeTaal==="engels"?"Tip/Wens EN":"Tip/Wens EL"]||"";

        kalenderContainer.innerHTML=`<div class="dagkalender-datum">${datumTekst}</div>
          <div class="vastenregel-regel">${vastenRegelBlok}</div>
          <div class="heiligenrij">${heiligen}</div>
          <div class="lezingblok"><b>${epLabel}:</b> ${epistel}</div>
          <div class="lezingblok"><b>${evLabel}:</b> ${evangelie}</div>`;
        tipBlok.innerHTML=tip;
      });
    }
    laadAlles();
  </script>
</body>
</html>

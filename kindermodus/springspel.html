<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Photeinos Springspel</title>
  <style>
    body { margin:0; font-family: sans-serif; background:#e0f7ff; overflow:hidden; }
    canvas { display:block; margin:0 auto; background:#cceeff; }
    #hud {
      position:absolute; top:10px; left:50%; transform:translateX(-50%);
      background:white; padding:8px 16px; border-radius:8px; font-weight:bold;
    }
    .overlay {
      position:absolute; top:0; left:0; width:100%; height:100%;
      background:rgba(0,0,0,0.6); color:white; display:none;
      align-items:center; justify-content:center; flex-direction:column;
      text-align:center; padding:20px;
    }
    button {
      margin:6px; padding:10px 20px; font-size:16px; cursor:pointer;
      border:none; border-radius:6px; background:#7bb235; color:white;
    }
  </style>
</head>
<body>

<canvas id="game" width="800" height="400"></canvas>
<div id="hud">Level 0 • Vragen 0/10 • Score 0</div>

<div id="start" class="overlay" style="display:flex;">
  <h2>Welkom bij het Photeinos Springspel!</h2>
  <p>Spring met de spatiebalk. Bots je tegen een icoon → dan krijg je een vraag.</p>
  <button id="startBtn">Start (kost 20 punten)</button>
</div>

<div id="question" class="overlay">
  <h2 id="qText"></h2>
  <div id="qAnswers"></div>
</div>

<div id="end" class="overlay">
  <h2 id="endText"></h2>
  <button id="again">Opnieuw spelen</button>
  <button id="back">Terug</button>
</div>

<script>
// --------------------------
// VRAGEN
// --------------------------
const lichtVragen = [
  { vraag: "Wat doe je als je wakker wordt?", opties: ["Een kort gebedje bidden", "Je bed uit springen zonder God te groeten"], juist: 0 },
  { vraag: "Wat doe je met het kruisteken?", opties: ["Je begint en eindigt je gebed ermee", "Alleen doen als anderen kijken"], juist: 0 }
];
const zondeVragen = [
  { vraag: "God helemaal vergeten en nooit bidden is goed.", juist: 1 },
  { vraag: "Grappen maken over God in de kerk is goed.", juist: 1 }
];

// --------------------------
// VARIABELEN
// --------------------------
let punten = 100, level = 1, vragenTeller = 0;
let running = false;
let spawnTimer = 0;
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// Speler
const playerImg = new Image();
playerImg.src = "images/photeinos_walk.gif";
let player = { x:100, y:300, vy:0, size:60, onGround:true };

// Obstakels en items
let objects = [];
const objectPool = [
  {icon:"🕊️", type:"item"}, {icon:"📦", type:"obstacle"},
  {icon:"🌵", type:"obstacle"}, {icon:"🐍", type:"obstacle"},
  {icon:"💎", type:"item"}, {icon:"🍇", type:"item"}
];

// --------------------------
// SPEL LOOP
// --------------------------
function loop() {
  if (!running) return;
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // grond tekenen
  ctx.fillStyle="#88cc66";
  ctx.fillRect(0,canvas.height-40,canvas.width,40);

  // speler
  ctx.drawImage(playerImg, player.x, player.y, player.size, player.size);

  // zwaartekracht
  player.vy += 0.8;
  player.y += player.vy;
  if (player.y >= canvas.height-40-player.size) {
    player.y = canvas.height-40-player.size;
    player.vy = 0; player.onGround = true;
  }

  // objecten
  for (let obj of objects) {
    ctx.font="32px serif";
    ctx.fillText(obj.icon, obj.x, obj.y);
    obj.x -= 4;

    // botsing
    if (Math.abs(obj.x-player.x)<30 && Math.abs(obj.y-player.y)<40) {
      if (obj.type==="item") askMeerkeuze();
      else askZonde();
      objects.splice(objects.indexOf(obj),1);
      break;
    }
  }

  // spawn
  spawnTimer--;
  if (spawnTimer<=0) {
    spawnObject();
    spawnTimer = 100+Math.random()*100;
  }

  requestAnimationFrame(loop);
}

function spawnObject() {
  const choice = objectPool[Math.floor(Math.random()*objectPool.length)];
  const y = canvas.height-50; // op de grond
  objects.push({ ...choice, x:canvas.width, y });
}

// --------------------------
// VRAGEN
// --------------------------
function askMeerkeuze(){
  running=false;
  const q=lichtVragen[Math.floor(Math.random()*lichtVragen.length)];
  document.getElementById("qText").textContent=q.vraag;
  const ans=document.getElementById("qAnswers"); ans.innerHTML="";
  q.opties.forEach((opt,i)=>{
    const b=document.createElement("button");
    b.textContent=opt;
    b.onclick=()=>{
      if(i===q.juist){ vragenTeller++; if(vragenTeller>=10){ level++; punten+=2; vragenTeller=0; if(level>5) endGame(); } updateHud(); }
      closeModal();
    };
    ans.appendChild(b);
  });
  document.getElementById("question").style.display="flex";
}
function askZonde(){
  running=false;
  const q=zondeVragen[Math.floor(Math.random()*zondeVragen.length)];
  document.getElementById("qText").textContent=q.vraag;
  const ans=document.getElementById("qAnswers"); ans.innerHTML="";
  ["Ja","Nee"].forEach((opt,i)=>{
    const b=document.createElement("button");
    b.textContent=opt;
    b.onclick=()=>{
      if((i===0 && q.juist===0)||(i===1 && q.juist===1)){ closeModal(); }
      else endGame();
    };
    ans.appendChild(b);
  });
  document.getElementById("question").style.display="flex";
}
function closeModal(){ document.getElementById("question").style.display="none"; running=true; loop(); }

// --------------------------
// HUD & END
// --------------------------
function updateHud(){ document.getElementById("hud").textContent=`Level ${level}/5 • Vragen ${vragenTeller}/10 • Score ${punten}`; }
function endGame(){
  running=false;
  document.getElementById("end").style.display="flex";
  document.getElementById("endText").textContent=`Eindscore: ${punten} • Level ${level}`;
}

// --------------------------
// CONTROLS
// --------------------------
window.addEventListener("keydown",e=>{
  if(e.code==="Space" && player.onGround){ player.vy=-15; player.onGround=false; }
});

// --------------------------
// START KNOP
// --------------------------
document.getElementById("startBtn").onclick=()=>{
  punten-=20; level=1; vragenTeller=0; updateHud();
  document.getElementById("start").style.display="none";
  running=true; loop();
};
document.getElementById("again").onclick=()=>{ location.reload(); };
document.getElementById("back").onclick=()=>{ history.back(); };
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Welkom â€“ Orthodoxe Kinderpagina</title>
  <link rel="icon" href="https://kathy-torfs.github.io/Orthodoxeweg/images/kruis.png" />
  <style>
    :root{
      --primair:#7bb235; --donker:#67510C;
      --pastel1:#fff6e5; --pastel2:#fffde6; --pastel3:#ffe8ec; --pastel4:#e7f8ff;
      --pastel5:#e6ffe5; --pastel6:#fff2fb; --pastel7:#f5ffe5; --pastel8:#f5e8ff;
      --pastel9:#fff6fb; --pastel10:#e7fff9; --pastel11:#f3e6ff; --pastel12:#ffeae6;
      --pastel13:#ecffe9; --pastel14:#f7fff3; --pastel15:#eafffa; --pastel16:#fff4ea;
    }
    body{
      margin:0; font-family:"Comic Sans MS",Arial,sans-serif; color:#333;
      min-height:100vh; background:var(--pastel1); transition:background .6s; overflow-x:hidden;
    }

    /* --- Pagina-inhoud (onder de header) --- */
    .welkom-blok{
      background:#fffce7; color:var(--donker);
      border-radius:23px; box-shadow:0 6px 32px #d7cbb144;
      font-size:1.36em; line-height:1.62; white-space:pre-line; text-align:center;
      max-width:850px; width:93vw; margin:28px auto; padding:30px 44px;
    }

    .photeinos-vlam-blok{
      position:relative; display:flex; flex-direction:column; align-items:center;
      width:330px; max-width:85vw; margin:38px auto 24px auto;
    }
    .photeinos-vlam-img{
      width:100%; display:block; user-drag:none; -webkit-user-drag:none;
    }
    .punten-teller-groot{
      position:absolute; left:0; right:0; top:70%;
      text-align:center; font-family:"Comic Sans MS",Arial,sans-serif;
      font-size:2.8em; color:#bf5300; font-weight:bold;
      text-shadow:0 2px 10px #fffef9, 0 1px 0 #ffecb3;
      pointer-events:none; letter-spacing:.03em; filter:drop-shadow(0 2px 2px #fffef9);
      transition:transform .14s;
    }

    @media (max-width:900px){
      .welkom-blok{ font-size:1.03em; padding:15px 2vw; }
      .photeinos-vlam-blok{ width:54vw; min-width:120px; }
      .punten-teller-groot{ font-size:1.6em; }
    }
    @media (max-width:550px){
      .photeinos-vlam-blok{ width:86vw; min-width:69px; }
      .punten-teller-groot{ font-size:1.09em; }
    }
  </style>
</head>
<body>
  <!-- Ingebouwde kinder-header (begroeting + vlammetje + menubalk + beveiliging) -->
  <div id="kid-header"></div>

  <!-- Pagina-inhoud -->
  <div class="welkom-blok">
Welkom in jouw Orthodoxe Kinderpagina, <span id="kind-naam-blok"></span>! ðŸŽ‰

ðŸŒŸ Hier mag je elke dag op avontuur: ontdek mooie verhalen, leer bidden, en speel leuke spelletjes!

Hoe meer jij bidt of leert, hoe meer punten je verdient en hoe meer spelletjes je kan spelen.

Veel plezier vandaag, en vergeet niet: Photeinos is altijd jouw vriendje onderweg! ðŸ¤©
  </div>

  <!-- Grote Photeinos met vlam en (grote) puntenaantal -->
  <div class="photeinos-vlam-blok">
    <img
      src="https://kathy-torfs.github.io/Orthodoxeweg/images/photeinos_vlam.png"
      alt="Photeinos met vlam"
      class="photeinos-vlam-img"
      draggable="false"
    />
    <div id="punten-teller-groot" class="punten-teller-groot">â€¦</div>
  </div>

  <!-- Kinder layout loader (laadt header.html, checkt login, zet begroeting & live punten in header) -->
  <script src="common/layout.js"></script>

  <script>
    // Naam in de welkomsttekst
    (function setNaam(){
      const naam = localStorage.getItem("ingelogdKindVoornaam") || "Kind";
      const el = document.getElementById("kind-naam-blok");
      if (el) el.textContent = naam;
    })();

    // Grote puntenâ€‘vlam: live sync met Firestore (zelfde document als in header)
    (function setupGroteTeller(){
      // Wacht tot Firebase en Firestore geladen zijn door layout.js
      function tryBind() {
        if (!(window.firebase && firebase.firestore)) {
          setTimeout(tryBind, 150);
          return;
        }
        const db = firebase.firestore();
        const parochieId = localStorage.getItem("ingelogdeParochie");
        const ouderLogin = localStorage.getItem("loginKeuze");
        const kindId = localStorage.getItem("ingelogdKindId");
        const teller = document.getElementById("punten-teller-groot");

        if (!teller || !parochieId || !ouderLogin || !kindId) return;

        const ref = db.collection("parochies").doc(parochieId)
          .collection("leden").doc(ouderLogin)
          .collection("kinderen").doc(kindId);

        ref.onSnapshot(
          snap => {
            const punten = snap.exists ? (snap.data().punten || 0) : 0;
            teller.textContent = punten;
            teller.style.transform = "scale(1.18)";
            setTimeout(() => (teller.style.transform = "scale(1)"), 160);
          },
          err => {
            console.warn("Grote puntenteller kon niet live updaten:", err);
            teller.textContent = "â€¦";
          }
        );
      }
      tryBind();
    })();
  </script>
</body>
</html>

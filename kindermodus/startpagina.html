<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Welkom â€“ Orthodoxe Kinderpagina</title>
  <link rel="icon" href="https://kathy-torfs.github.io/Orthodoxeweg/images/kruis.png">
  <style>
    :root {
      --primair: #7bb235;
      --donker: #67510C;
      --pastel1: #fff6e5;
      --pastel2: #fffde6;
      --pastel3: #ffe8ec;
      --pastel4: #e7f8ff;
      --pastel5: #e6ffe5;
      --pastel6: #fff2fb;
      --pastel7: #f5ffe5;
      --pastel8: #f5e8ff;
    }
    body {
      margin: 0;
      font-family: 'Comic Sans MS', Arial, sans-serif;
      color: #333;
      min-height: 100vh;
      background: var(--pastel1);
      transition: background 0.6s;
      overflow-x: hidden;
    }
    .bovenrij {
      width: 100%;
      max-width: 1280px;
      margin: 0 auto 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0;
      padding: 22px 2vw 8px 2vw;
      box-sizing: border-box;
      margin-bottom: 38px; /* <-- MEER RUIMTE ONDER BEGROETING */
    }
    .bovenrij .links {
      display: flex;
      align-items: center;
      gap: 18px;
    }
    .photeinos-wave-img {
      width: 92px;
      min-width: 54px;
      max-width: 18vw;
      height: auto;
      border-radius: 50%;
      background: #fff;
      border: 2.2px solid #dab97a;
      box-shadow: 0 2px 12px #dab97a2a;
      object-fit: cover;
      margin-right: 0;
      user-drag: none;
      -webkit-user-drag: none;
      display: block;
    }
    .begroeting {
      font-size: 2.2em;
      font-weight: bold;
      color: var(--primair);
      text-shadow: 0 2px 8px #b3d9ff44;
      letter-spacing: 0.01em;
      line-height: 1.04;
      margin-top: 0;
      margin-bottom: 0;
      text-align: left;
      white-space: nowrap;
    }
    .bovenrij .rechts {
      margin-left: 24px;
    }
    .uitlog-kind-btn {
      background: #e24343;
      color: #fff;
      border: none;
      padding: 11px 24px;
      border-radius: 9px;
      font-weight: bold;
      font-size: 1.1em;
      cursor: pointer;
      box-shadow: 0 2px 10px #b04141ab;
      transition: background 0.2s;
      z-index: 10;
      margin-left: 12px;
    }
    .uitlog-kind-btn:hover { background: #b72828; }

    nav.kinder-menu {
      width: 100vw;
      max-width: 1280px;
      margin: 0 auto 0 auto;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 22px; /* iets groter */
      padding: 0 0 15px 0;
      box-sizing: border-box;
      min-height: 62px;
      flex-wrap: wrap;
    }
    nav.kinder-menu a {
      display: flex;
      align-items: center;
      justify-content: center;
      background: none;
      border: none;
      box-shadow: none;
      padding: 0;
      cursor: pointer;
      outline: none;
      border-radius: 12px;
      transition: transform 0.13s;
    }
    nav.kinder-menu a:focus, nav.kinder-menu a:hover {
      transform: scale(1.12);
    }
    .menu-icoon {
      width: 74px;
      height: 74px;
      object-fit: contain;
      border-radius: 12px;
      background: #fff9d5;
      box-shadow: 0 2px 7px #ffe17e25;
      border: 2px solid #ffe05e;
      transition: box-shadow 0.13s, border-color 0.13s;
      display: block;
    }
    nav.kinder-menu a:focus .menu-icoon,
    nav.kinder-menu a:hover .menu-icoon {
      box-shadow: 0 5px 16px #ffe17e55;
      border-color: #ffbe23;
    }
    @media (max-width: 900px) {
      .menu-icoon { width: 48px; height: 48px;}
      nav.kinder-menu { gap: 12px;}
    }
    @media (max-width: 600px) {
      .menu-icoon { width: 31px; height: 31px;}
      nav.kinder-menu { gap: 4px;}
    }
    .welkom-blok {
      background: #fffce7;
      border-radius: 23px;
      box-shadow: 0 6px 32px #d7cbb144;
      color: var(--donker);
      font-size: 1.36em;
      padding: 30px 44px 30px 44px;
      margin: 28px auto 28px auto;
      line-height: 1.62;
      max-width: 850px;
      width: 93vw;
      white-space: pre-line;
      text-align: center;
    }
    .photeinos-vlam-blok {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 330px;
      max-width: 85vw;
      margin: 38px auto 20px auto; /* iets meer boven/onderruimte */
    }
    .photeinos-vlam-img {
      width: 100%;
      display: block;
      user-drag: none;
      -webkit-user-drag: none;
    }
    .punten-teller {
      position: absolute;
      left: 0; right: 0;
      top: 73%; /* 63% â†’ 73%: iets lager in de vlam! */
      text-align: center;
      font-family: 'Comic Sans MS', Arial, sans-serif;
      font-size: 2.8em;
      color: #bf5300;
      font-weight: bold;
      text-shadow: 0 2px 10px #fffef9, 0 1px 0 #ffecb3;
      pointer-events: none;
      letter-spacing: 0.03em;
      filter: drop-shadow(0 2px 2px #fffef9);
      transition: transform 0.14s;
    }
    @media (max-width: 900px) {
      .bovenrij { padding-top: 10px; }
      .photeinos-wave-img { width: 12vw; min-width: 34px; }
      .begroeting { font-size: 1.2em;}
      .welkom-blok { font-size: 1.03em; padding: 15px 2vw; }
      .photeinos-vlam-blok { width: 54vw; min-width: 120px;}
    }
    @media (max-width: 550px) {
      .bovenrij { padding: 6px 1vw 4px 1vw; }
      .photeinos-wave-img { width: 19vw; min-width: 23px; }
      .begroeting { font-size: 0.99em;}
      nav.kinder-menu { gap: 4px; min-height: 32px;}
      .welkom-blok { font-size: 0.91em; padding: 7px 1vw; }
      .photeinos-vlam-blok { width: 86vw; min-width: 69px;}
      .punten-teller { font-size: 1.15em;}
      .uitlog-kind-btn { padding: 7px 11px; font-size: 0.91em;}
      .menu-icoon { width: 25px; height: 25px;}
    }
  </style>
  <!-- FIREBASE SCRIPTS -->
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore-compat.js"></script>
</head>
<body>
  <!-- Bovenste rij: ster, begroeting, uitloggen -->
  <div class="bovenrij">
    <div class="links">
      <img src="https://kathy-torfs.github.io/Orthodoxeweg/images/photeinos_wave.gif" alt="Photeinos zwaait" class="photeinos-wave-img" draggable="false">
      <span class="begroeting" id="groet-tekst">Hallo, kind!</span>
    </div>
    <div class="rechts">
      <button class="uitlog-kind-btn" onclick="uitloggenKind()">Uitloggen</button>
    </div>
  </div>

  <!-- KinderApp Menubalk (1 rij, juiste volgorde) -->
  <nav class="kinder-menu">
    <a href="startpagina.html" title="Startpagina">
      <img src="https://kathy-torfs.github.io/Orthodoxeweg/images/photeinos_home.png" alt="Startpagina" class="menu-icoon">
    </a>
    <a href="gebeden.html" title="Ik bid">
      <img src="https://kathy-torfs.github.io/Orthodoxeweg/images/photeinos_bid.png" alt="Ik bid" class="menu-icoon">
    </a>
    <a href="catechese.html" title="Catechese">
      <img src="https://kathy-torfs.github.io/Orthodoxeweg/images/catechese.png" alt="Catechese" class="menu-icoon">
    </a>
    <a href="heiligen.html" title="Heiligen">
      <img src="https://kathy-torfs.github.io/Orthodoxeweg/images/photeinos_heiligen.png" alt="Heiligen" class="menu-icoon">
    </a>
    <a href="bijbelverhalen.html" title="Bijbelverhalen">
      <img src="https://kathy-torfs.github.io/Orthodoxeweg/images/photeinos_bijbel.png" alt="Bijbelverhalen" class="menu-icoon">
    </a>
    <a href="spelletjes.html" title="Spelletjes">
      <img src="https://kathy-torfs.github.io/Orthodoxeweg/images/photeinos_spelletjes.png" alt="Spelletjes" class="menu-icoon">
    </a>
    <a href="school.html" title="School">
      <img src="https://kathy-torfs.github.io/Orthodoxeweg/images/photeinos_school.png" alt="School" class="menu-icoon">
    </a>
  </nav>

  <!-- Welkomsttekst -->
  <div class="welkom-blok">
Welkom in jouw Orthodoxe Kinderpagina, <span id="kind-naam-blok"></span>! ðŸŽ‰

ðŸŒŸ Hier mag je elke dag op avontuur: ontdek mooie verhalen, leer bidden, en speel leuke spelletjes!

Hoe meer jij bidt of leert, hoe meer punten je verdient en hoe meer spelletjes je kan spelen.

Veel plezier vandaag, en vergeet niet: Photeinos is altijd jouw vriendje onderweg! ðŸ¤©
  </div>

  <!-- Grote Photeinos met vlam en puntenaantal -->
  <div class="photeinos-vlam-blok">
    <img src="https://kathy-torfs.github.io/Orthodoxeweg/images/photeinos_vlam.png" alt="Photeinos met vlam" class="photeinos-vlam-img" draggable="false">
    <div id="punten-teller" class="punten-teller">...</div>
  </div>

  <script>
    // Altijd een andere kleur (niet dezelfde als vorige sessie)
    const pastelKleuren = [
      'var(--pastel1)', 'var(--pastel2)', 'var(--pastel3)', 'var(--pastel4)',
      'var(--pastel5)', 'var(--pastel6)', 'var(--pastel7)', 'var(--pastel8)'
    ];
    // Onthoud de vorige index in sessionStorage
    let prevIndex = Number(sessionStorage.getItem("prevColorIndex"));
    let kleurIndex = Math.floor(Math.random() * pastelKleuren.length);
    // Altijd andere dan vorige (tenzij de allereerste keer)
    while (pastelKleuren.length > 1 && kleurIndex === prevIndex) {
      kleurIndex = Math.floor(Math.random() * pastelKleuren.length);
    }
    document.body.style.background = pastelKleuren[kleurIndex];
    sessionStorage.setItem("prevColorIndex", kleurIndex);

    // Haal naam uit localStorage
    const kindNaam = localStorage.getItem("ingelogdKindVoornaam") || "Kind";
    document.getElementById('kind-naam-blok').textContent = kindNaam;

    // Persoonlijke begroeting
    function welkomstGroet() {
      const uur = new Date().getHours();
      if (uur >= 6 && uur <= 11) return "Goeiemorgen";
      if (uur >= 12 && uur <= 16) return "Goeiemiddag";
      if (uur >= 17 && uur <= 22) return "Goeieavond";
      return "Hallo";
    }
    document.getElementById("groet-tekst").textContent = `${welkomstGroet()}, ${kindNaam}!`;

    // Uitloggen kind
    function uitloggenKind() {
      localStorage.removeItem("kindIngelogd");
      localStorage.removeItem("ingelogdKindId");
      localStorage.removeItem("ingelogdKindVoornaam");
      localStorage.removeItem("kindAvatarURL");
      localStorage.removeItem("kindPunten");
      window.location.href = "https://kathy-torfs.github.io/Orthodoxeweg/volwassenmodus/parochie.html";
    }

    // ==== FIREBASE CONFIG EN PUNTEN OPHALEN ====
    const firebaseConfig = {
      apiKey: "AIzaSyBG1iQBmruHUZI1OeW8RgbJ_TPit_7a2LQ",
      authDomain: "orthodoxeweg.firebaseapp.com",
      projectId: "orthodoxeweg",
      storageBucket: "orthodoxeweg.appspot.com",
      messagingSenderId: "408582263618",
      appId: "1:408582263618:web:0a20f4bf0704989d3ceedb"
    };
    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Ophalen uit localStorage
    const parochieId = localStorage.getItem("ingelogdeParochie");
    const ouderLogin = localStorage.getItem("loginKeuze");
    const kindId = localStorage.getItem("ingelogdKindId");

    async function laadPunten() {
      const teller = document.getElementById("punten-teller");
      if (!parochieId || !ouderLogin || !kindId) {
        teller.textContent = "â€¦";
        return;
      }
      try {
        const kindDoc = await db.collection("parochies")
          .doc(parochieId)
          .collection("leden")
          .doc(ouderLogin)
          .collection("kinderen")
          .doc(kindId)
          .get();
        let punten = 0;
        if (kindDoc.exists) {
          punten = kindDoc.data().punten || 0;
        }
        teller.textContent = punten;
        teller.style.transform = 'scale(1.18)';
        setTimeout(() => { teller.style.transform = 'scale(1)'; }, 180);
      } catch {
        teller.textContent = "â€¦";
      }
    }
    laadPunten();
  </script>
</body>
</html>

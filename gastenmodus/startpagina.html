<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Orthodoxeweg - Dagkalender</title>
  <style>
    body {
      background: #f5e9b8;
      margin: 0; padding: 0;
      color: #574016;
      font-family: 'Georgia', 'Times New Roman', serif;
    }
    nav.menu {
      background: #7a5f35;
      padding: 12px 18px;
      display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;
    }
    nav.menu a {
      color: #f5e9b8; text-decoration: none; font-weight: 600; font-size: 1.1em;
      padding: 6px 14px; border-radius: 7px; transition: background 0.3s;
    }
    nav.menu a:hover { background: #5d4726; text-decoration: underline; }
    .boek-container {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 0;
      min-height: 80vh;
      margin: 3vw auto 5vw auto;
      max-width: 1140px;
    }
    .boek-blad {
      background: #faf8f3;
      border: 2.6px solid #a48f67;
      border-radius: 0 0 28px 28px / 0 0 40px 40px;
      box-shadow: 0 6px 40px #ccb38c7a, 0 0 0 6px #e4dcc8 inset;
      width: 330px; min-height: 530px; max-width: 95vw;
      padding: 44px 26px 32px 26px;
      margin: 0 -6px;
      position: relative;
      display: flex;
      flex-direction: column;
      box-sizing: border-box;
      z-index: 2;
    }
    .boek-blad.links { border-right: none; z-index: 3; }
    .boek-blad.rechts { border-left: none; z-index: 2;}
    .blad-scheiding {
      width: 8px;
      background: linear-gradient(to bottom, #cbb98a 0%, #eee4cb 100%);
      border-radius: 12px;
      margin-top: 38px; margin-bottom: 38px;
      box-shadow: 1.5px 0 0 #c8b07b inset;
      z-index: 4;
    }
    .heilige-blok h3 {
      margin-top: 0; font-size: 1.28em; text-align: center; font-family: Georgia, serif;
      letter-spacing: 0.5px;
    }
    .heilige-icoon {
      display: block;
      margin: 15px auto 10px auto;
      max-width: 120px; max-height: 120px;
      border-radius: 12px; box-shadow: 0 2px 14px #a08c68a0;
      background: #f9f7f2;
    }
    .heilige-verhaal {
      font-size: 1.07em; text-align: justify; color: #4a3820;
      max-height: 160px; overflow-y: auto;
      margin: 12px 2px 0 2px;
      padding: 4px 2px;
      line-height: 1.35;
      border-radius: 7px;
      background: #f4ead3;
      box-shadow: 0 1px 0 #e9debe;
    }
    .blad-datum {
      font-size: 2em; text-align: center; margin-bottom: 6px;
      font-family: 'Georgia', serif; letter-spacing: 1.6px; font-weight: bold;
      color: #85642f; text-shadow: 0 1px 0 #f6efd6;
    }
    .vastenregel {
      text-align: center; font-size: 1.14em; font-weight: 700;
      color: #943b23; margin-bottom: 14px; letter-spacing: 0.1em;
      display: flex; justify-content: center; align-items: center; gap: 10px;
    }
    .heiligen-dag {
      background: #f4ead3;
      border-radius: 8px; padding: 6px 10px; margin: 0 0 14px 0; font-size: 1.13em;
      color: #5b3912;
    }
    .lezing-dag {
      background: #f8f3e6;
      border-radius: 8px;
      margin-bottom: 10px; padding: 7px 9px;
      font-size: 1.09em;
    }
    .dagtip {
      text-align: center;
      font-style: italic;
      font-size: 1.05em;
      color: #b69769;
      margin: 30px auto 0 auto;
      max-width: 92%;
      background: none;
      border: none;
      padding: 0;
      box-shadow: none;
    }
    .nav-btns {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .blad-pijl {
      background: #ebd4aa;
      border: 2px solid #c4b07c;
      color: #85642f;
      width: 46px; height: 46px;
      border-radius: 50%;
      font-size: 2em; font-weight: 700;
      cursor: pointer; user-select: none;
      display: flex; align-items: center; justify-content: center;
      box-shadow: 0 2px 6px #ccb38c3a;
      transition: background 0.19s, box-shadow 0.19s;
    }
    .blad-pijl:hover { background: #faebc8; box-shadow: 0 4px 16px #d2c69e80; }
    .taal-keuze {
      text-align: right;
      margin: 0 0 18px 0;
    }
    .taal-keuze button {
      font-family: inherit; font-size: 1em; padding: 5px 13px; margin-left: 7px;
      border: none; border-radius: 7px; background: #e4dcc8; color: #634f26;
      font-weight: 600; cursor: pointer;
      transition: background 0.22s;
    }
    .taal-keuze button.selected { background: #bfa171; color: #fff; }
    @media (max-width: 950px) {
      .boek-container { max-width: 98vw; }
      .boek-blad { width: 45vw; min-width: 200px; padding: 18px 4vw; }
    }
    @media (max-width: 700px) {
      .boek-container {
        flex-direction: column;
        align-items: center;
        gap: 0;
      }
      .boek-blad { width: 98vw; max-width: 99vw; min-width: unset; padding: 18px 2vw;}
      .blad-scheiding { display: none; }
      .boek-blad.links, .boek-blad.rechts { border-radius: 0 0 18px 18px / 0 0 22px 22px; }
    }
  </style>
  <!-- FIREBASE SCRIPTS EN CONFIG -->
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBG1iQBmruHUZI1OeW8RgbJ_TPit_7a2LQ",
      authDomain: "orthodoxeweg.firebaseapp.com",
      projectId: "orthodoxeweg",
      storageBucket: "orthodoxeweg.appspot.com",
      messagingSenderId: "408582263618",
      appId: "1:408582263618:web:0a20f4bf0704989d3ceedb",
      measurementId: "G-C942F2NYQV"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>
</head>
<body>
<nav class="menu">
  <a href="https://kathy-torfs.github.io/Orthodoxeweg/gastenmodus/startpagina.html">🏠 Home</a>
  <a href="https://kathy-torfs.github.io/Orthodoxeweg/gastenmodus/catechese/catechese.html">📖 Catechese</a>
  <a href="https://kathy-torfs.github.io/Orthodoxeweg/gastenmodus/psalmen/psalmen.html">📜 Psalmen</a>
  <a href="https://kathy-torfs.github.io/Orthodoxeweg/gastenmodus/gebeden/gebeden.html">🙏 Gebeden</a>
  <a href="https://kathy-torfs.github.io/Orthodoxeweg/gastenmodus/gebeden/geloofsbelijdenis.html">✝ Geloofsbelijdenis</a>
  <a href="https://kathy-torfs.github.io/Orthodoxeweg/gastenmodus/heiligen/heiligen.html">🌟 Heiligen</a>
  <a href="https://kathy-torfs.github.io/Orthodoxeweg/gastenmodus/menu/recepten.html">🍽️ Recepten</a>
</nav>
<div class="taal-keuze">
  <span>Taal:</span>
  <button class="selected" onclick="setTaal('NL')" id="btn-nl">NL Vlaams</button>
  <button onclick="setTaal('EN')" id="btn-en">EN Engels</button>
  <button onclick="setTaal('EL')" id="btn-el">GR Grieks</button>
</div>
<div class="boek-container">
  <div class="boek-blad links" id="boek-links">
    <!-- Heilige van de dag, wordt geladen via JS -->
    <div id="heiligen-inhoud" style="min-height:330px;text-align:center;">
      <p style="color:#c5b493; font-style:italic; margin-top:100px;">Laden...</p>
    </div>
  </div>
  <div class="blad-scheiding"></div>
  <div class="boek-blad rechts" id="boek-rechts">
    <!-- Dagkalender wordt geladen via JS -->
    <div class="nav-btns">
      <button class="blad-pijl" id="btn-prev" title="Vorige dag">&#8592;</button>
      <span style="font-size:1.08em;color:#a28e62;">Blader door de kalender</span>
      <button class="blad-pijl" id="btn-next" title="Volgende dag">&#8594;</button>
    </div>
    <div id="kalender-inhoud">
      <p style="color:#c5b493; font-style:italic; text-align:center;">Laden...</p>
    </div>
  </div>
</div>
<script>
let taal = 'NL';

// Helper om datum als YYYYMMDD te krijgen
function formatDateToId(d) {
  const yyyy = d.getFullYear();
  const mm = String(d.getMonth()+1).padStart(2,'0');
  const dd = String(d.getDate()).padStart(2,'0');
  return `${yyyy}${mm}${dd}`;
}
// Helper om datum als MM-DD te krijgen (voor heiligen)
function formatDateToFeestdag(d) {
  const mm = String(d.getMonth()+1).padStart(2,'0');
  const dd = String(d.getDate()).padStart(2,'0');
  return `${mm}-${dd}`;
}
// Helper om datum als mooie string te tonen
function formatDatePretty(d, taal) {
  const maanden = {
    NL: ['januari','februari','maart','april','mei','juni','juli','augustus','september','oktober','november','december'],
    EN: ['January','February','March','April','May','June','July','August','September','October','November','December'],
    EL: ['Ιανουαρίου','Φεβρουαρίου','Μαρτίου','Απριλίου','Μαΐου','Ιουνίου','Ιουλίου','Αυγούστου','Σεπτεμβρίου','Οκτωβρίου','Νοεμβρίου','Δεκεμβρίου']
  };
  const maand = maanden[taal][d.getMonth()];
  if(taal==='NL') return `${d.getDate()} ${maand} ${d.getFullYear()}`;
  if(taal==='EN') return `${maand} ${d.getDate()}, ${d.getFullYear()}`;
  if(taal==='EL') return `${d.getDate()} ${maand} ${d.getFullYear()}`;
  return d.toISOString().substring(0,10);
}

// ===== HEILIGE VAN DE DAG (LINKER PAGINA) =====
function laadHeiligeVanDeDag(datum) {
  const feestdag = formatDateToFeestdag(datum);
  const heiligenContainer = document.getElementById('heiligen-inhoud');
  heiligenContainer.innerHTML = "<p style='color:#c5b493; font-style:italic; margin-top:100px;'>Laden...</p>";
  db.collection('heiligen').where('feestdag','==',feestdag).get().then(snapshot => {
    if(snapshot.empty) {
      heiligenContainer.innerHTML = "<p style='margin-top:110px;color:#beae93;'>Geen heilige van de dag gevonden.</p>";
      return;
    }
    // Pak 1 random heilige (indien meer dan 1)
    const docs = snapshot.docs;
    const doc = docs[Math.floor(Math.random() * docs.length)];
    const data = doc.data();
    let naam = data.id || 'Heilige van de dag';
    let icoon = data.icon || 'https://upload.wikimedia.org/wikipedia/commons/7/76/Orthodox_cross.svg';
    let levensverhaal = data.levensverhaal_volwassenen || "<em>Levensverhaal volgt nog...</em>";

    heiligenContainer.innerHTML = `
      <h3>${naam}</h3>
      <img src="${icoon}" alt="icoon van ${naam}" class="heilige-icoon" />
      <div class="heilige-verhaal">${levensverhaal}</div>
    `;
  });
}

// ===== DAGKALENDER (RECHTER PAGINA) =====
let huidigeDatum = new Date();
function laadDagkalender(d) {
  const kalenderEl = document.getElementById('kalender-inhoud');
  kalenderEl.innerHTML = "<p style='color:#c5b493; font-style:italic; text-align:center;'>Laden...</p>";
  const docId = formatDateToId(d);
  db.collection('kalender2025').doc(docId).get().then(doc => {
    if(!doc.exists) {
      kalenderEl.innerHTML = "<p style='text-align:center;color:#beae93;'>Geen kalendergegevens voor deze dag.</p>";
      return;
    }
    const data = doc.data();
    // Taalmapjes (voor kolomnamen per taal)
    const veld = {
      'NL': {
        heiligen: 'Heiligen NL',
        vasten: 'Vastenregel NL',
        tip: 'Tip/Wens NL',
        epistel: 'Epistel Ref NL (netjes NL)',
        evangelie: 'Evangelie Ref NL (netjes NL)'
      },
      'EN': {
        heiligen: 'Heiligen EN',
        vasten: 'Vastenregel EN',
        tip: 'Tip/Wens EN',
        epistel: 'Epistel Ref EN (netjes NL)',
        evangelie: 'Evangelie Ref EN (netjes NL)'
      },
      'EL': {
        heiligen: 'Heiligen EL',
        vasten: 'Vastenregel EL', // mocht je deze ooit toevoegen
        tip: 'Tip/Wens EL',
        epistel: 'Epistel Ref EL (netjes NL)',
        evangelie: 'Evangelie Ref EL (netjes NL)'
      }
    }[taal];

    // Vastenregel + symbool
    let vasten = data[veld.vasten] || data['Vastenregel NL'] || 'Vastenvrij';
    let symbool = data.Symbool ? ` <span style="font-size:1.2em">${data.Symbool}</span>` : '';

    // Heiligen tonen
    let heiligen = data[veld.heiligen] || '';
    if(heiligen) heiligen = heiligen.split(';').map(x=>x.trim()).filter(x=>x).join(', ');

    kalenderEl.innerHTML = `
      <div class="blad-datum">${formatDatePretty(d, taal)}</div>
      <div class="vastenregel">${vasten}${symbool}</div>
      <div class="heiligen-dag">${heiligen}</div>
      <div class="lezing-dag"><b>Apostellezing:</b> ${data[veld.epistel]||''}</div>
      <div class="lezing-dag"><b>Evangelie:</b> ${data[veld.evangelie]||''}</div>
      <div class="dagtip">${data[veld.tip]||''}</div>
    `;
  });
}

// ===== NAVIGATIE (VORIGE / VOLGENDE DAG) =====
document.getElementById('btn-prev').onclick = function() {
  huidigeDatum.setDate(huidigeDatum.getDate() - 1);
  laadHeiligeVanDeDag(huidigeDatum);
  laadDagkalender(huidigeDatum);
}
document.getElementById('btn-next').onclick = function() {
  huidigeDatum.setDate(huidigeDatum.getDate() + 1);
  laadHeiligeVanDeDag(huidigeDatum);
  laadDagkalender(huidigeDatum);
}

// ===== TAALKEUZE =====
function setTaal(nieuweTaal) {
  taal = nieuweTaal;
  document.getElementById('btn-nl').classList.toggle('selected', taal==='NL');
  document.getElementById('btn-en').classList.toggle('selected', taal==='EN');
  document.getElementById('btn-el').classList.toggle('selected', taal==='EL');
  laadHeiligeVanDeDag(huidigeDatum);
  laadDagkalender(huidigeDatum);
}

// Initieer pagina met vandaag
window.onload = function() {
  laadHeiligeVanDeDag(huidigeDatum);
  laadDagkalender(huidigeDatum);
};
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Horologion - Orthodoxeweg</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  <style>
    html, body {
      height: 100%; margin: 0; padding: 0; box-sizing: border-box;
      width: 100vw; min-width: 100vw; max-width: 100vw;
    }
    body {
      width: 100vw; height: 100vh; min-height: 100vh; max-height: 100vh;
      overflow: auto;
      display: flex; align-items: center; justify-content: center;
      background: #222;
    }
    .img-container {
      position: relative;
      width: 98vw; max-width: 700px;
      aspect-ratio: 4/5;
      height: auto; max-height: 98vh; min-height: 320px;
      box-sizing: border-box;
      border-radius: 16px;
      box-shadow: 0 0 48px #000a;
      background: #444;
      display: flex; align-items: center; justify-content: center;
    }
    .img-container img {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 1;
      filter: brightness(0.98) blur(0px);
    }
    .overlay {
      position: relative;
      z-index: 2;
      width: 100%; height: 100%;
      display: flex; flex-direction: column; justify-content: space-between;
      align-items: stretch; color: #fff; text-shadow: 0 3px 12px #000b;
      font-family: 'Segoe UI', Georgia, serif;
      pointer-events: none; box-sizing: border-box; padding: 0 0.5em;
    }
    .bovenrij {
      display: flex; flex-direction: column; align-items: flex-start;
      width: 100%; margin-top: 1em; font-size: 1.07em; font-weight: 500;
      gap: 0.5em; pointer-events: none;
    }
    .bovenrij span {
      background: rgba(35,35,35,0.33); border-radius: 8px;
      padding: 0.28em 0.7em; min-width: 80px; text-align: left;
    }
    .datum { font-size: 1.14em; font-weight: 500; padding: 0.4em 1.1em; background: rgba(38,38,38,0.47); }
    .tijd {
      margin: 1.2em auto 0.8em auto; width: 88%; font-size: 2.2em; font-weight: 700;
      letter-spacing: 0.06em; text-align: center; background: rgba(35,35,35,0.30);
      border-radius: 12px; box-shadow: 0 1px 8px #0005; padding: 0.13em;
    }
    .horologion-midden {
      width: 92%; margin: 0 auto; background: rgba(35,35,35,0.45); border-radius: 10px;
      box-shadow: 0 2px 12px #0007; padding: 1em; font-size: 1.09em;
      text-align: center; min-height: 2.2em; display: flex;
      flex-direction: column; gap: 0.6em; align-items: center; justify-content: center;
      pointer-events: auto;
    }
    .onder {
      width: 100%; display: flex; flex-direction: column; align-items: center;
      gap: 0.5em; margin-bottom: 0.7em;
    }
    .vastenregel {
      background: rgba(40,40,40,0.42); border-radius: 10px; box-shadow: 0 1px 9px #0005;
      padding: 0.65em 1em; font-size: 1.02em; font-weight: 500; text-align: center;
      color: #ffecb3; max-width: 97vw; word-break: break-word;
    }
    .taal-select-wrap {
      align-self: flex-end; background: rgba(40,40,40,0.54); border-radius: 8px;
      padding: 0.22em 0.75em; pointer-events: auto; box-shadow: 0 2px 12px #0007;
      font-size: 1.08em; opacity: 0.96; display: flex; align-items: center;
      gap: 0.4em; transition: opacity 0.18s; margin-bottom: 0.7em;
    }
    .taal-select-wrap label { color: #ffdba2; letter-spacing: 0.04em; }
    .taal-select-wrap select {
      font-size: 1em; border: none; background: rgba(60,60,60,0.31); color: #fff;
      border-radius: 4px; padding: 0.18em 0.3em; outline: none;
    }
  </style>
</head>
<body>
  <div class="img-container">
    <img src="images/moeder_gods.jpg" alt="Moeder Gods icoon" />
    <div class="overlay">
      <div class="bovenrij">
        <span id="datum"></span>
        <span id="zonsopgang"></span>
        <span id="zonsondergang"></span>
        <span id="temperatuur"></span>
      </div>
      <div class="tijd" id="tijd"></div>
      <div class="horologion-midden" id="horologion"></div>
      <div class="onder">
        <div class="vastenregel" id="vastenregel"></div>
      </div>
      <div class="taal-select-wrap">
        <label><span id="taallabel">Taal:</span></label>
        <select id="taalkeuze">
          <option value="VL">Vlaams</option><option value="FR">Frans</option>
          <option value="DE">Duits</option><option value="EN">Engels</option>
          <option value="GR">Grieks</option><option value="AR">Arabisch</option>
          <option value="RU">Russisch</option><option value="UA">Oekraïens</option>
        </select>
      </div>
    </div>
  </div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBG1iQBmruHUZI1OeW8RgbJ_TPit_7a2LQ",
  authDomain: "orthodoxeweg.firebaseapp.com",
  projectId: "orthodoxeweg"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

const moederGodGebed = { "VL":"...", "EN":"...", "FR":"...", "DE":"...", "GR":"...", "AR":"...", "RU":"...", "UA":"..." };
const jezusGebed = { "VL":"...", "EN":"...", "FR":"...", "DE":"...", "GR":"...", "AR":"...", "RU":"...", "UA":"..." };
let geselecteerdeTaal = "VL";
let zonsopgangMinuten = null, zonsondergangMinuten = null;

document.getElementById('taalkeuze').addEventListener('change', e => {
  geselecteerdeTaal = e.target.value;
  updateUI();
});

function updateUI() {
  const now = new Date(), uur = now.getHours(), min = now.getMinutes();
  document.getElementById('datum').textContent = now.toLocaleDateString('nl-BE',{ day:'numeric', month:'short', year:'numeric'});
  document.getElementById('tijd').textContent = `${String(uur).padStart(2,'0')}:${String(min).padStart(2,'0')}`;
  updateWeather();
  updateGebeden();
}
function updateWeather() {
  navigator.geolocation.getCurrentPosition(pos => {
    fetch(`https://api.open-meteo.com/v1/forecast?latitude=${pos.coords.latitude}&longitude=${pos.coords.longitude}&current_weather=true&daily=sunrise,sunset&timezone=Europe%2FBrussels`)
      .then(res=>res.json()).then(data=>{
        const t = data.current_weather?.temperature;
        document.getElementById('temperatuur').textContent = t!==undefined? `${Math.round(t)}°C`:"...";
        const sr = new Date(data.daily.sunrise[0]), ss = new Date(data.daily.sunset[0]);
        zonsopgangMinuten = sr.getHours()*60+sr.getMinutes();
        zonsondergangMinuten = ss.getHours()*60+ss.getMinutes();
        document.getElementById('zonsopgang').textContent = `Zonsopgang ${sr.getHours().toString().padStart(2,'0')}:${sr.getMinutes().toString().padStart(2,'0')}`;
        document.getElementById('zonsondergang').textContent = `Zonsondergang ${ss.getHours().toString().padStart(2,'0')}:${ss.getMinutes().toString().padStart(2,'0')}`;
      });
  }, ()=>{}, {maximumAge:600000});
}
function updateGebeden() {
  const now = new Date(), nuMin = now.getHours()*60+now.getMinutes(), datum = now.toISOString().slice(0,10).replace(/-/g,"");
  let moment = "complet";
  if (zonsopgangMinuten!=null && zonsondergangMinuten!=null) {
    if (nuMin<zonsopgangMinuten) moment="6"; 
    else if (nuMin<zonsopgangMinuten+180) moment="0";
    else if (nuMin<zonsopgangMinuten+360) moment="1";
    else if (nuMin<zonsopgangMinuten+540) moment="2";
    else if (nuMin<zonsondergangMinuten) moment="3";
    else if (nuMin<zonsondergangMinuten+120) moment="4";
    else moment="6";
  }
  db.collection("gebeden_uren").doc(moment).get().then(doc=>{
    const lang = doc.exists && (doc.data()[geselecteerdeTaal]||"");
    const kort = doc.exists && (doc.data()[`${geselecteerdeTaal}_KORT`]||"");
    const horoDiv = document.getElementById('horologion');
    horoDiv.innerHTML="";
    if (lang && nuMin < zonsopgangMinuten+60 || nuMin < zonsondergangMinuten+60) {
      horoDiv.textContent = lang;
    } else {
      if (kort) horoDiv.innerHTML += `<div>${kort}</div>`;
      horoDiv.innerHTML += `<div>${ (now.getHours()%2===0 ? moederGodGebed[geselecteerdeTaal] : jezusGebed[geselecteerdeTaal]) || moederGodGebed["VL"] }</div>`;
    }
  });
  db.collection("kalender2025").doc(datum).get().then(doc=>{
    let tekst = doc.exists ? (doc.data()["Vastenregel "+geselecteerdeTaal]||"Vastenvrij") : "Vastenvrij";
    document.getElementById('vastenregel').textContent = tekst;
  });
}
setInterval(updateUI,60000);
updateUI();
</script>
</body>
</html>

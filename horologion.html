<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Horologion - Orthodoxeweg</title>
  <style>
    html, body {
      height: 100%; margin: 0; padding: 0; box-sizing: border-box;
      width: 100vw; background: #222; color: #fff; font-family: 'Segoe UI', Georgia, serif;
      display: flex; align-items: center; justify-content: center;
    }
    .container {
      width: 98vw; max-width: 700px; aspect-ratio: 4/5;
      background: #444; border-radius: 16px; box-shadow: 0 0 48px #000a;
      display: flex; flex-direction: column; justify-content: space-between;
      padding: 1em; box-sizing: border-box; position: relative;
    }
    .bovenrij {
      display: flex; justify-content: space-between; align-items: flex-start; gap: 1em;
    }
    .links { display: flex; flex-direction: column; gap: 0.3em; }
    .midden { text-align: center; }
    .rechts { }
    .tijd { margin-top: 0.3em; font-size: 2.1em; font-weight: 700; }
    .horologion { 
      flex: 1; display: flex; align-items: center; justify-content: center;
      background: rgba(35,35,35,0.45); border-radius: 10px; box-shadow: 0 2px 12px #0007;
      padding: 1em; margin: 0.7em 0; font-size: 1.08em; text-align: center;
    }
    .vastenregel {
      background: rgba(40,40,40,0.42); border-radius: 10px; box-shadow: 0 1px 9px #0005;
      padding: 0.65em 1em; font-size: 1em; font-weight: 500; text-align: center;
      color: #ffecb3; word-break: break-word;
    }
    .taalkeuze {
      position: absolute; right: 1em; bottom: 1em;
      background: rgba(40,40,40,0.54); border-radius: 8px; padding: 0.3em 0.6em;
      display: flex; align-items: center; gap: 0.4em;
      box-shadow: 0 2px 12px #0007;
    }
    .taalkeuze label { color: #ffdba2; }
    .taalkeuze select {
      font-size: 1em; border: none; background: rgba(60,60,60,0.31); color: #fff;
      border-radius: 4px; padding: 0.18em 0.3em; outline: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="bovenrij">
      <div class="links">
        <div id="zonsopgang">zonsopgang ...</div>
        <div id="zonsondergang">zonsondergang ...</div>
      </div>
      <div class="midden">
        <div id="datum">1 jul 2025</div>
        <div class="tijd" id="tijd">17:58</div>
      </div>
      <div class="rechts">
        <div id="temperatuur">...</div>
      </div>
    </div>
    <div class="horologion" id="horologion"></div>
    <div class="vastenregel" id="vastenregel"></div>
    <div class="taalkeuze">
      <label for="taalkeuze" id="taallabel">Taal:</label>
      <select id="taalkeuze">
        <option value="VL">Vlaams</option>
        <option value="FR">Frans</option>
        <option value="DE">Duits</option>
        <option value="EN">Engels</option>
        <option value="GR">Grieks</option>
        <option value="AR">Arabisch</option>
        <option value="RU">Russisch</option>
        <option value="UA">Oekraïens</option>
      </select>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  <script>
    // Je volledige script zoals jij het gaf, klein beetje opgeschoond voor stabiliteit
    const vertalingen = { /* zelfde object als hierboven */ };
    const moederGodGebed = { /* idem zoals je eerder gaf */ };
    const jezusGebed = { /* idem zoals je eerder gaf */ };

    const firebaseConfig = {
      apiKey: "AIzaSyBG1iQBmruHUZI1OeW8RgbJ_TPit_7a2LQ",
      authDomain: "orthodoxeweg.firebaseapp.com",
      projectId: "orthodoxeweg",
      storageBucket: "orthodoxeweg.fir...
      messagingSenderId: "408582263618",
      appId: "1:408582263618:web:0a20f4bf0704989d3ceedb"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    let geselecteerdeTaal = "VL";
    let zonsopgangMinuten = null, zonsondergangMinuten = null;

    document.getElementById('taalkeuze').addEventListener('change', function() {
      geselecteerdeTaal = this.value;
      document.getElementById('taallabel').textContent = vertalingen["taal"][geselecteerdeTaal] || vertalingen["taal"]["VL"];
      updateZonsLabels(); updateHorologionEnVastenregel();
    });

    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById('taallabel').textContent = vertalingen["taal"][geselecteerdeTaal] || vertalingen["taal"]["VL"];
    });

    function updateWidget() {
      const nu = new Date(), maand = ["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"];
      document.getElementById('datum').textContent = `${nu.getDate()} ${maand[nu.getMonth()]} ${nu.getFullYear()}`;
      let hh = nu.getHours().toString().padStart(2,"0"), mm = nu.getMinutes().toString().padStart(2,"0");
      document.getElementById('tijd').textContent = `${hh}:${mm}`;
    }
    setInterval(updateWidget, 1000); updateWidget();

    function updateWeather(lat, lon) {
      fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&daily=sunrise,sunset&timezone=Europe%2FBerlin`)
        .then(res => res.json())
        .then(data => {
          if (data.current_weather?.temperature)
            document.getElementById('temperatuur').textContent = `${Math.round(data.current_weather.temperature)}°C`;
          else document.getElementById('temperatuur').textContent = '...';
          if (data.daily?.sunrise && data.daily?.sunset) {
            const sUp = new Date(data.daily.sunrise[0]), sDown = new Date(data.daily.sunset[0]);
            zonsopgangMinuten = sUp.getHours()*60 + sUp.getMinutes();
            zonsondergangMinuten = sDown.getHours()*60 + sDown.getMinutes();
            document.getElementById('zonsopgang').textContent = `${vertalingen["zonsopgang"][geselecteerdeTaal]} ${sUp.getHours().toString().padStart(2,'0')}:${sUp.getMinutes().toString().padStart(2,'0')}`;
            document.getElementById('zonsondergang').textContent = `${vertalingen["zonsondergang"][geselecteerdeTaal]} ${sDown.getHours().toString().padStart(2,'0')}:${sDown.getMinutes().toString().padStart(2,'0')}`;
            updateHorologionEnVastenregel();
          }
        }).catch(()=> document.getElementById('temperatuur').textContent = '...');
    }
    function initWeather(){
      if ('geolocation' in navigator)
        navigator.geolocation.getCurrentPosition(
          pos => { updateWeather(pos.coords.latitude,pos.coords.longitude); setInterval(()=>updateWeather(pos.coords.latitude,pos.coords.longitude),600000); },
          () => { updateWeather(50.85,4.35); setInterval(()=>updateWeather(50.85,4.35),600000); }
        );
      else { updateWeather(50.85,4.35); setInterval(()=>updateWeather(50.85,4.35),600000); }
    }
    initWeather();

    function updateZonsLabels(){
      let zo = document.getElementById('zonsopgang').textContent.match(/\d{2}:\d{2}/)||["..."];
      let zs = document.getElementById('zonsondergang').textContent.match(/\d{2}:\d{2}/)||["..."];
      document.getElementById('zonsopgang').textContent = `${vertalingen["zonsopgang"][geselecteerdeTaal]} ${zo[0]}`;
      document.getElementById('zonsondergang').textContent = `${vertalingen["zonsondergang"][geselecteerdeTaal]} ${zs[0]}`;
    }

    function bepaalGebedsmoment(){
      const nu = new Date(), nuMin = nu.getHours()*60 + nu.getMinutes();
      if (zonsopgangMinuten==null||zonsondergangMinuten==null) return 6;
      if (nuMin < zonsopgangMinuten) return 6;
      if (nuMin < zonsopgangMinuten+180) return 0;
      if (nuMin < zonsopgangMinuten+360) return 1;
      if (nuMin < zonsopgangMinuten+540) return 2;
      if (nuMin < zonsondergangMinuten) return 3;
      if (nuMin < zonsondergangMinuten+60) return 4;
      return 5;
    }

    function zoekTekst(doc, lijst){
      for (let key of lijst) if(doc.data()[key]) return doc.data()[key];
      return "";
    }

    function updateHorologionEnVastenregel(){
      const datum = (new Date()).toISOString().slice(0,10).replace(/-/g,""), moment = bepaalGebedsmoment(), uur = new Date().getHours();
      db.collection("gebeden_uren").doc(String(moment)).get().then(doc=>{
        let tekst="", prioriteiten={ "DE":["DE","VL","EN"], "FR":["FR","EN","VL"], "GR":["GR","EN","VL"], "AR":["AR","EN","VL"],
          "RU":["RU","UA","EN","VL"], "UA":["UA","RU","EN","VL"], "EN":["EN","VL"], "VL":["VL","EN"] };
        if(doc.exists) tekst = zoekTekst(doc, prioriteiten[geselecteerdeTaal]||["VL","EN"]);
        if(tekst&&tekst.trim()!=="") document.getElementById('horologion').innerHTML=`<div>${tekst}</div>`;
        else {
          let kort=zoekTekst(doc, Object.keys(doc.data()).filter(k=>k.includes("_KORT"))), fallback= uur%2===0? moederGodGebed[geselecteerdeTaal]: jezusGebed[geselecteerdeTaal];
          document.getElementById('horologion').innerHTML = `<div>${kort||fallback}</div>${kort?"<div>"+fallback+"</div>":""}`;
        }
      });
      db.collection("kalender2025").doc(datum).get().then(doc=>{
        let tekst="", prioriteiten={ "DE":["Vastenregel DE","Vastenregel NL","Vastenregel EN"], "FR":["Vastenregel FR","Vastenregel EN","Vastenregel NL"],
          "GR":["Vastenregel GR","Vastenregel EN","Vastenregel NL"], "AR":["Vastenregel AR","Vastenregel EN","Vastenregel NL"],
          "RU":["Vastenregel RU","Vastenregel UA","Vastenregel EN","Vastenregel NL"], "UA":["Vastenregel UA","Vastenregel RU","Vastenregel EN","Vastenregel NL"],
          "EN":["Vastenregel EN","Vastenregel NL"], "VL":["Vastenregel NL","Vastenregel EN"] };
        if(doc.exists) tekst=zoekTekst(doc,prioriteiten[geselecteerdeTaal]||["Vastenregel NL","Vastenregel EN"]);
        if(!tekst) tekst={"EN":"No fasting","FR":"Jour sans jeûne","DE":"Fastenfrei","GR":"Ἀπολυτή. Ἀργία.","AR":"يوم بدون صوم","RU":"Поста нет","UA":"Без посту","VL":"Vastenvrij"}[geselecteerdeTaal]||"Vastenvrij";
        document.getElementById('vastenregel').textContent=tekst;
      });
    }
    setInterval(updateHorologionEnVastenregel,60000); updateHorologionEnVastenregel();
  </script>
</body>
</html>

</html>
<script>
